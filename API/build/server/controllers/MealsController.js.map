{"version":3,"sources":["../../../server/controllers/MealsController.js"],"names":["MealsController","req","res","mealsService","getAllMeals","meals","count","status","send","add","body","addedMeal","errors","err","name","original","detail","mealId","params","id","modify","modMeal","delete","delMeal"],"mappings":";;;;;;;AAGA;;AACA;;;;;;;;;;;;;;IAEMA,e;;;;;;;;;;;;+CACWC,G,EAAKC,G;;;;;;;uBACEC,sBAAaC,WAAb,E;;;AAAdC,gBAAAA,K;;AACN;;;AAGA,oBAAIA,KAAK,CAACC,KAAN,KAAgB,CAApB,EAAuB;AACrBJ,kBAAAA,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,CAAC,4BAAD,CAArB;AACD,iBAFD,MAEO;AACLN,kBAAAA,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBH,KAArB;AACD;;;;;;;;;;;;;;;;;;;;;gDAGWJ,G,EAAKC,G;;;;;;;uBACOC,sBAAaM,GAAb,CAAiBR,GAAG,CAACS,IAArB,C;;;AAAlBC,gBAAAA,S;;AACN,oBAAIA,SAAS,CAACC,MAAd,EAAsB;AACdC,kBAAAA,GADc,GACR,yBAAgBF,SAAS,CAACC,MAA1B,CADQ;AAEpBV,kBAAAA,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBK,GAArB;AACD,iBAHD,MAGO,IAAIF,SAAS,CAACG,IAAV,KAAmB,oCAAvB,EAA6D;AAClEZ,kBAAAA,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,CAACG,SAAS,CAACI,QAAV,CAAmBC,MAApB,CAArB;AACD,iBAFM,MAEA;AACLd,kBAAAA,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBG,SAArB;AACD;;;;;;;;;;;;;;;;;;;;;gDAGcV,G,EAAKC,G;;;;;;AACde,gBAAAA,M,GAAShB,GAAG,CAACiB,MAAJ,CAAWC,E;;uBACJhB,sBAAaiB,MAAb,CAAoBnB,GAAG,CAACS,IAAxB,EAA8BO,MAA9B,C;;;AAAhBI,gBAAAA,O;;AACN,oBAAIA,OAAO,CAAC,CAAD,CAAP,KAAe,CAAf,IAAoBA,OAAO,CAACP,IAAR,KAAiB,wBAAzC,EAAmE;AACjEZ,kBAAAA,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,CAAC,kBAAD,CAArB;AACD,iBAFD,MAEO,IAAIa,OAAO,CAACT,MAAZ,EAAoB;AACnBC,kBAAAA,GADmB,GACb,yBAAgBQ,OAAO,CAACT,MAAxB,CADa;AAEzBV,kBAAAA,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBK,GAArB;AACD,iBAHM,MAGA;AACLX,kBAAAA,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBa,OAArB;AACD;;;;;;;;;;;;;;;;;;;;;gDAGcpB,G,EAAKC,G;;;;;;AACde,gBAAAA,M,GAAShB,GAAG,CAACiB,MAAJ,CAAWC,E;;uBACJhB,sBAAamB,MAAb,CAAoBL,MAApB,C;;;AAAhBM,gBAAAA,O;;AAEN,oBAAIA,OAAO,CAACT,IAAR,KAAiB,wBAAjB,IAA6CS,OAAO,KAAK,CAA7D,EAAgE;AAC9DrB,kBAAAA,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,CAAC,kBAAD,CAArB;AACD,iBAFD,MAEO;AACLN,kBAAAA,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,CAAC,4BAAD,CAArB;AACD;;;;;;;;;;;;;;;;;;;;;eAIU,IAAIR,eAAJ,E","sourcesContent":["/* eslint-disable linebreak-style */\r\n/* eslint-disable class-methods-use-this */\r\n\r\nimport mealsService from '../services/MealsService';\r\nimport getErrorMessage from '../helpers/allHelpers';\r\n\r\nclass MealsController {\r\n  async getMeals(req, res) {\r\n    const meals = await mealsService.getAllMeals();\r\n    /* if (meals.errors) {\r\n      res.status(400).send(meals.errors);\r\n    } */\r\n    if (meals.count === 0) {\r\n      res.status(200).send(['No meals yets. Add a meal.']);\r\n    } else {\r\n      res.status(200).send(meals);\r\n    }\r\n  }\r\n\r\n  async addMeal(req, res) {\r\n    const addedMeal = await mealsService.add(req.body);\r\n    if (addedMeal.errors) {\r\n      const err = getErrorMessage(addedMeal.errors);\r\n      res.status(400).send(err);\r\n    } else if (addedMeal.name === 'SequelizeForeignKeyConstraintError') {\r\n      res.status(400).send([addedMeal.original.detail]);\r\n    } else {\r\n      res.status(201).send(addedMeal);\r\n    }\r\n  }\r\n\r\n  async modifyMeal(req, res) {\r\n    const mealId = req.params.id;\r\n    const modMeal = await mealsService.modify(req.body, mealId);\r\n    if (modMeal[0] === 0 || modMeal.name === 'SequelizeDatabaseError') {\r\n      res.status(404).send(['Invalid meal id.']);\r\n    } else if (modMeal.errors) {\r\n      const err = getErrorMessage(modMeal.errors);\r\n      res.status(400).send(err);\r\n    } else {\r\n      res.status(200).send(modMeal);\r\n    }\r\n  }\r\n\r\n  async deleteMeal(req, res) {\r\n    const mealId = req.params.id;\r\n    const delMeal = await mealsService.delete(mealId);\r\n\r\n    if (delMeal.name === 'SequelizeDatabaseError' || delMeal === 0) {\r\n      res.status(404).send(['Invalid meal id.']);\r\n    } else {\r\n      res.status(200).send(['Meal successfully deleted.']);\r\n    }\r\n  }\r\n}\r\n\r\nexport default new MealsController();\r\n"],"file":"MealsController.js"}
